// android/app/build.gradle
import java.util.Properties
import java.io.FileInputStream

plugins {
    id 'com.android.application'
    id 'kotlin-android'
    // Apply Flutter plugin once (app module only)
    id 'dev.flutter.flutter-gradle-plugin'
}

// Load release keystore props (key.properties at android/key.properties)
def keyProps = new Properties()
def keyPropsFile = rootProject.file("key.properties")
if (keyPropsFile.exists()) {
    keyProps.load(new FileInputStream(keyPropsFile))
}

android {
    // ‚ùó Set your final package name before creating the Play app
    namespace "com.yourcompany.braw3"
    compileSdk flutter.compileSdkVersion
    ndkVersion flutter.ndkVersion

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }
    kotlinOptions { jvmTarget = JavaVersion.VERSION_11.toString() }

    defaultConfig {
        // MUST match the Play Console app id you create
        applicationId "com.yourcompany.braw3"
        minSdk flutter.minSdkVersion
        targetSdk flutter.targetSdkVersion

        // üî¢ Bump for every Play upload
        versionCode 1
        versionName "1.0.0"
    }

    signingConfigs {
        release {
            if (keyPropsFile.exists()) {
                storeFile file(keyProps["storeFile"])
                storePassword keyProps["storePassword"]
                keyAlias keyProps["keyAlias"]
                keyPassword keyProps["keyPassword"]
            } else {
                // Fallback to debug if you haven't created key.properties yet
                signingConfig signingConfigs.debug
            }
        }
    }

    buildTypes {
        release {
            signingConfig signingConfigs.release
            // Enable later if you want shrinking
            // minifyEnabled true
            // shrinkResources true
            // proguardFiles getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro"
        }
        debug {
            // default debug signing
        }
    }
}

flutter {
    source "../.."
}
